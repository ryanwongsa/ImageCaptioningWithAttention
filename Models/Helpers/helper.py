import tensorflow as tf

# tf.enable_eager_execution()

def load_image(image_path):
    img = tf.read_file(image_path)
    img = tf.image.decode_jpeg(img, channels=3)
    img = tf.image.resize_images(img, (299, 299))
    img = tf.keras.applications.inception_v3.preprocess_input(img)
    return img, image_path

def gru(units):
    # can't load onto cpu if this is enabled
#     if tf.test.is_gpu_available():
#         return tf.keras.layers.CuDNNGRU(units, 
#                                     return_sequences=True, 
#                                     return_state=True, 
#                                     recurrent_initializer='glorot_uniform')
#     else:
    return tf.keras.layers.GRU(units, 
                           return_sequences=True, 
                           return_state=True, 
                           recurrent_activation='sigmoid', 
                           recurrent_initializer='glorot_uniform')